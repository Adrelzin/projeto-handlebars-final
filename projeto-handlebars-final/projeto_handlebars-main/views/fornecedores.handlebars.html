<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{#if detalhe}}Detalhes{{else}}{{#if form}}{{#if fornecedor}}Editar{{else}}Cadastrar{{/if}}{{else}}Lista de{{/if}}{{/if}} Fornecedores</title>
    <link rel='icon' href='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQxTHUcZmxfBVVwDhiaJlD6hnpNCyp_jaMpnQ&s'>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; position: relative; }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('/images/Background.jpg'); background-size: cover;
            background-position: center; background-attachment: fixed; opacity: 0.60; z-index: -1;
        }
        header { background-color: rgba(255, 255, 255, 0.95); padding: 20px; text-align: center; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); }
        header h2 { color: #FF5722; font-size: 28px; margin-bottom: 10px; }
        .container { max-width: 900px; margin: 40px auto; background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); }
        ul { list-style: none; margin-bottom: 20px; }
        li { padding: 15px; margin-bottom: 10px; background-color: rgba(249, 249, 249, 0.95); border-left: 4px solid #FF5722; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; transition: transform 0.2s, box-shadow 0.2s; }
        li:hover { transform: translateX(5px); box-shadow: 0 2px 8px rgba(255, 87, 34, 0.3); }
        li .info a { color: #333; text-decoration: none; font-weight: bold; }
        li .info a:hover { color: #FF5722; }
        li .actions { display: flex; gap: 10px; }
        li .actions a { padding: 8px 16px; background-color: #2196F3; color: white; text-decoration: none; border-radius: 4px; font-size: 14px; transition: background-color 0.2s, transform 0.2s; }
        li .actions a:hover { background-color: #0b7dda; transform: translateY(-2px); }
        li .actions button { padding: 8px 16px; background-color: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; transition: background-color 0.2s, transform 0.2s; }
        li .actions button:hover { background-color: #da190b; transform: translateY(-2px); }
        form { display: flex; flex-direction: column; gap: 15px; }
        label { font-weight: bold; color: #333; }
        input { padding: 12px; font-size: 14px; border: 1px solid #ddd; border-radius: 5px; transition: border-color 0.2s; }
        input:focus { outline: none; border-color: #FF5722; box-shadow: 0 0 5px rgba(255, 87, 34, 0.3); }
        .detail-item { padding: 15px; margin-bottom: 10px; background-color: rgba(249, 249, 249, 0.95); border-left: 4px solid #FF5722; border-radius: 4px; }
        .detail-item strong { color: #FF5722; display: inline-block; min-width: 150px; }
        .reestoques-section { margin-top: 30px; padding-top: 20px; border-top: 2px solid #FF5722; }
        .reestoques-section h3 { color: #FF5722; margin-bottom: 15px; font-size: 20px; }
        .reestoque-item { padding: 12px; margin-bottom: 8px; background-color: rgba(255, 255, 255, 0.95); border-left: 3px solid #009688; border-radius: 4px; transition: transform 0.2s; }
        .reestoque-item:hover { transform: translateX(5px); box-shadow: 0 2px 5px rgba(0, 150, 136, 0.3); }
        .empty-message { padding: 20px; text-align: center; color: #999; font-style: italic; background-color: rgba(249, 249, 249, 0.95); border-radius: 4px; }
        button[type="submit"], .btn-new { padding: 12px 24px; background-color: #FF5722; color: white; border: none; border-radius: 5px; cursor: pointer; text-decoration: none; display: inline-block; font-weight: bold; transition: background-color 0.2s, transform 0.2s; }
        button[type="submit"]:hover, .btn-new:hover { background-color: #E64A19; transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); }
        .back-link { display: inline-block; padding: 12px 24px; color: #FF5722; text-decoration: none; font-weight: bold; margin-left: 10px; border: 2px solid #FF5722; border-radius: 5px; transition: background-color 0.2s, color 0.2s; }
        .back-link:hover { background-color: #FF5722; color: white; }
    </style>
</head>
<body>
    <header>
        <h2>
            {{#if detalhe}}Detalhes do Fornecedor
            {{else}}{{#if form}}{{#if fornecedor}}Editar Fornecedor{{else}}Cadastrar Fornecedor{{/if}}
            {{else}}Lista de Fornecedores{{/if}}{{/if}}
        </h2>
    </header>
    <div class="container">
        {{#if lista}}
        <ul>
            {{#each fornecedores}}
            <li>
                <div class="info">
                    <a href="/fornecedores/ver/{{id}}">{{nome}}</a> - CNPJ: {{cnpj}} - Telefone: {{telefone}}
                </div>
                <div class="actions">
                    <a href="/fornecedores/{{id}}/editar">Editar</a>
                    <form action="/fornecedores/excluir/{{id}}" method="POST" style="margin:0;">
                        <button type="submit" onclick="return confirm('Confirma exclusão?')">Excluir</button>
                    </form>
                </div>
            </li>
            {{/each}}
        </ul>
        <a href="/fornecedores/novo" class="btn-new">+ Cadastrar Novo Fornecedor</a>
        <a href="/" class="back-link">← Voltar</a>
        {{/if}}

        {{#if form}}
        <form action="{{#if fornecedor}}/fornecedores/{{fornecedor.id}}/editar{{else}}/fornecedores{{/if}}" method="POST">
            <label for="nome">Nome:</label>
            <input type="text" name="nome" id="nome" value="{{fornecedor.nome}}" placeholder="Ex: Papelaria Central" required>

            <label for="cnpj">CNPJ:</label>
            <input type="text" name="cnpj" id="cnpj" value="{{fornecedor.cnpj}}" placeholder="Ex: 12.345.678/0001-90" required>

            <label for="telefone">Telefone:</label>
            <input type="text" name="telefone" id="telefone" value="{{fornecedor.telefone}}" placeholder="Ex: (81) 3333-1111" required>

            <label for="email">Email:</label>
            <input type="email" name="email" id="email" value="{{fornecedor.email}}" placeholder="Ex: contato@fornecedor.com" required>

            <label for="endereco">Endereço:</label>
            <input type="text" name="endereco" id="endereco" value="{{fornecedor.endereco}}" placeholder="Ex: Rua A, 123">

            <button type="submit">{{#if fornecedor}}Salvar Alterações{{else}}Cadastrar{{/if}}</button>
        </form>
        <a href="/fornecedores" class="back-link">← Voltar</a>
        {{/if}}

        {{#if detalhe}}
        <div class="detail-item"><strong>ID:</strong> {{fornecedor.id}}</div>
        <div class="detail-item"><strong>Nome:</strong> {{fornecedor.nome}}</div>
        <div class="detail-item"><strong>CNPJ:</strong> {{fornecedor.cnpj}}</div>
        <div class="detail-item"><strong>Telefone:</strong> {{fornecedor.telefone}}</div>
        <div class="detail-item"><strong>Email:</strong> {{fornecedor.email}}</div>
        <div class="detail-item"><strong>Endereço:</strong> {{fornecedor.endereco}}</div>

        <div class="reestoques-section">
            <h3>Histórico de Reestoques ({{fornecedor.Reestoques.length}})</h3>
            {{#if fornecedor.Reestoques.length}}
            <ul style="list-style: none; margin: 0;">
                {{#each fornecedor.Reestoques}}
                <li class="reestoque-item">
                    <strong>{{Material.nome}}</strong><br>
                    Quantidade: {{quantidade}} | Valor Unit.: R$ {{valorUnitario}} | Total: R$ {{valorTotal}}<br>
                    Data: {{dataReestoque}} | NF: {{notaFiscal}}
                </li>
                {{/each}}
            </ul>
            {{else}}
            <div class="empty-message">
                Nenhum reestoque registrado para este fornecedor.
            </div>
            {{/if}}
        </div>

        <a href="/fornecedores" class="back-link">← Voltar</a>
        {{/if}}
    </div>
</body>
</html>